(function(){"use strict";var sr={},fr;function Yr(){return fr||(fr=1,(()=>{var jr=Object.create,lr=Object.defineProperty,Fr=Object.getOwnPropertyDescriptor,cr=Object.getOwnPropertyNames,Nr=Object.getPrototypeOf,kr=Object.prototype.hasOwnProperty,zr=(l,c)=>function(){return c||(0,l[cr(l)[0]])((c={exports:{}}).exports,c),c.exports},Xr=(l,c,p,d)=>{if(c&&typeof c=="object"||typeof c=="function")for(let w of cr(c))!kr.call(l,w)&&w!==p&&lr(l,w,{get:()=>c[w],enumerable:!(d=Fr(c,w))||d.enumerable});return l},Zr=(l,c,p)=>(p=l!=null?jr(Nr(l)):{},Xr(!l||!l.__esModule?lr(p,"default",{value:l,enumerable:!0}):p,l)),Lr=zr({"dist/cjs/libImage.js"(l,c){var p=(()=>{var d=typeof document<"u"?document.currentScript?.src:void 0;return async function(w={}){var E,i=w,B="./this.program",D="",L;try{D=new URL(".",d).href}catch{}L=async r=>{if(r=await fetch(r,{credentials:"same-origin"}),r.ok)return r.arrayBuffer();throw Error(r.status+" : "+r.url)};var z=console.log.bind(console),R=console.error.bind(console),X,Q=!1,pr,gr,V,q,I,H,b,m,v,yr,wr,mr,dr,Ar=!1;function $r(){var r=V.buffer;q=new Int8Array(r),H=new Int16Array(r),I=new Uint8Array(r),b=new Uint16Array(r),m=new Int32Array(r),v=new Uint32Array(r),yr=new Float32Array(r),wr=new Float64Array(r),mr=new BigInt64Array(r),dr=new BigUint64Array(r)}function K(r){throw i.onAbort?.(r),r="Aborted("+r+")",R(r),Q=!0,r=new WebAssembly.RuntimeError(r+". Build with -sASSERTIONS for more info."),gr?.(r),r}var rr;async function Qr(r){if(!X)try{var e=await L(r);return new Uint8Array(e)}catch{}if(r==rr&&X)r=new Uint8Array(X);else throw"both async and sync fetching of the wasm failed";return r}async function qr(r,e){try{var t=await Qr(r);return await WebAssembly.instantiate(t,e)}catch(n){R(`failed to asynchronously prepare wasm: ${n}`),K(n)}}async function Kr(r){var e=rr;if(!X)try{var t=fetch(e,{credentials:"same-origin"});return await WebAssembly.instantiateStreaming(t,r)}catch(n){R(`wasm streaming compile failed: ${n}`),R("falling back to ArrayBuffer instantiation")}return qr(e,r)}class re{name="ExitStatus";constructor(e){this.message=`Program terminated with exit(${e})`,this.status=e}}var Er=r=>{for(;0<r.length;)r.shift()(i)},Pr=[],Ir=[],ee=()=>{var r=i.preRun.shift();Ir.push(r)},Or=!0,_r=new TextDecoder,er=(r,e,t,n)=>{if(t=e+t,n)return t;for(;r[e]&&!(e>=t);)++e;return e},Z=(r,e,t)=>r?_r.decode(I.subarray(r,er(I,r,e,t))):"";class te{constructor(e){this.aa=e-24}}var Rr=0,A=r=>{for(var e="";;){var t=I[r++];if(!t)return e;e+=String.fromCharCode(t)}},F={},Y={},G={},P=class extends Error{constructor(r){super(r),this.name="BindingError"}};function ne(r,e,t={}){var n=e.name;if(!r)throw new P(`type "${n}" must have a positive integer typeid pointer`);if(Y.hasOwnProperty(r)){if(t.ca)return;throw new P(`Cannot register type '${n}' twice`)}Y[r]=e,delete G[r],F.hasOwnProperty(r)&&(e=F[r],delete F[r],e.forEach(a=>a()))}function O(r,e,t={}){return ne(r,e,t)}var Wr=(r,e,t)=>{switch(e){case 1:return t?n=>q[n]:n=>I[n];case 2:return t?n=>H[n>>1]:n=>b[n>>1];case 4:return t?n=>m[n>>2]:n=>v[n>>2];case 8:return t?n=>mr[n>>3]:n=>dr[n>>3];default:throw new TypeError(`invalid integer width (${e}): ${r}`)}},Mr=[],N=[0,1,,1,null,1,!0,1,!1,1],tr=r=>{9<r&&--N[r+1]===0&&(N[r]=void 0,Mr.push(r))},W=r=>{if(!r)throw new P(`Cannot use deleted val. handle = ${r}`);return N[r]},J=r=>{switch(r){case void 0:return 2;case null:return 4;case!0:return 6;case!1:return 8;default:const e=Mr.pop()||N.length;return N[e]=r,N[e+1]=1,e}};function nr(r){return this.W(v[r>>2])}var ae={name:"emscripten::val",W:r=>{var e=W(r);return tr(r),e},Y:(r,e)=>J(e),$:nr,Z:null},ie=(r,e)=>{switch(e){case 4:return function(t){return this.W(yr[t>>2])};case 8:return function(t){return this.W(wr[t>>3])};default:throw new TypeError(`invalid float width (${e}): ${r}`)}},xr=(r,e)=>Object.defineProperty(e,"name",{value:r});function oe(r){for(var e=1;e<r.length;++e)if(r[e]!==null&&r[e].Z===void 0)return!0;return!1}function ue(r,e,t,n){var a=e.length;if(2>a)throw new P("argTypes array size mismatch! Must at least get return value and 'this' types!");e[1];var o=oe(e),u=!e[0].da,s=a-2,f=Array(s),h=[],y=[];return xr(r,function(...$){y.length=0,h.length=1,h[0]=n;for(var U,g=0;g<s;++g)f[g]=e[g+2].Y(y,$[g]),h.push(f[g]);if($=t(...h),o)for(;y.length;)U=y.pop(),y.pop()(U);else for(g=2;g<e.length;g++){var C=g===1?U:f[g-2];e[g].Z!==null&&e[g].Z(C)}return U=u?e[0].W($):void 0,U})}var se=(r,e)=>{if(i[r].X===void 0){var t=i[r];i[r]=function(...n){if(!i[r].X.hasOwnProperty(n.length))throw new P(`Function '${e}' called with an invalid number of arguments (${n.length}) - expects one of (${i[r].X})!`);return i[r].X[n.length].apply(this,n)},i[r].X=[],i[r].X[t.ba]=t}},fe=(r,e,t)=>{if(i.hasOwnProperty(r)){if(t===void 0||i[r].X!==void 0&&i[r].X[t]!==void 0)throw new P(`Cannot register public name '${r}' twice`);if(se(r,r),i[r].X.hasOwnProperty(t))throw new P(`Cannot register multiple overloads of a function with the same number of arguments (${t})!`);i[r].X[t]=e}else i[r]=e,i[r].ba=t},le=(r,e)=>{for(var t=[],n=0;n<r;n++)t.push(v[e+4*n>>2]);return t},Sr=class extends Error{constructor(r){super(r),this.name="InternalError"}},_,ce=(r,e)=>{r=A(r);var t=_.get(e);if(typeof t!="function")throw new P(`unknown function pointer with signature ${r}: ${e}`);return t};class ve extends Error{}var Tr=r=>{r=Dr(r);var e=A(r);return M(r),e},he=(r,e)=>{function t(o){a[o]||Y[o]||(G[o]?G[o].forEach(t):(n.push(o),a[o]=!0))}var n=[],a={};throw e.forEach(t),new ve(`${r}: `+n.map(Tr).join([", "]))},pe=(r,e)=>{function t(s){if(s=e(s),s.length!==n.length)throw new Sr("Mismatched type converter count");for(var f=0;f<n.length;++f)O(n[f],s[f])}var n=[];n.forEach(s=>G[s]=r);var a=Array(r.length),o=[],u=0;r.forEach((s,f)=>{Y.hasOwnProperty(s)?a[f]=Y[s]:(o.push(s),F.hasOwnProperty(s)||(F[s]=[]),F[s].push(()=>{a[f]=Y[s],++u,u===o.length&&t(a)}))}),o.length===0&&t(a)},ge=r=>{r=r.trim();const e=r.indexOf("(");return e===-1?r:r.slice(0,e)},k=(r,e,t)=>{var n=I;if(!(0<t))return 0;var a=e;t=e+t-1;for(var o=0;o<r.length;++o){var u=r.codePointAt(o);if(127>=u){if(e>=t)break;n[e++]=u}else if(2047>=u){if(e+1>=t)break;n[e++]=192|u>>6,n[e++]=128|u&63}else if(65535>=u){if(e+2>=t)break;n[e++]=224|u>>12,n[e++]=128|u>>6&63,n[e++]=128|u&63}else{if(e+3>=t)break;n[e++]=240|u>>18,n[e++]=128|u>>12&63,n[e++]=128|u>>6&63,n[e++]=128|u&63,o++}}return n[e]=0,e-a},Ur=r=>{for(var e=0,t=0;t<r.length;++t){var n=r.charCodeAt(t);127>=n?e++:2047>=n?e+=2:55296<=n&&57343>=n?(e+=4,++t):e+=3}return e},ye=new TextDecoder("utf-16le"),we=(r,e,t)=>(r>>=1,ye.decode(b.subarray(r,er(b,r,e/2,t)))),me=(r,e,t)=>{if(t??=2147483647,2>t)return 0;t-=2;var n=e;t=t<2*r.length?t/2:r.length;for(var a=0;a<t;++a)H[e>>1]=r.charCodeAt(a),e+=2;return H[e>>1]=0,e-n},de=r=>2*r.length,Ae=(r,e,t)=>{var n="";r>>=2;for(var a=0;!(a>=e/4);a++){var o=v[r+a];if(!o&&!t)break;n+=String.fromCodePoint(o)}return n},$e=(r,e,t)=>{if(t??=2147483647,4>t)return 0;var n=e;t=n+t-4;for(var a=0;a<r.length;++a){var o=r.codePointAt(a);if(65535<o&&a++,m[e>>2]=o,e+=4,e+4>t)break}return m[e>>2]=0,e-n},Ee=r=>{for(var e=0,t=0;t<r.length;++t)65535<r.codePointAt(t)&&t++,e+=4;return e},ar=[],Pe=r=>{var e=ar.length;return ar.push(r),e},Ie=(r,e)=>{for(var t=Array(r),n=0;n<r;++n){var a=n,o=v[e+4*n>>2],u=Y[o];if(u===void 0)throw r=`${`parameter ${n}`} has unknown type ${Tr(o)}`,new P(r);t[a]=u}return t},Oe={},Cr=r=>{var e=Oe[r];return e===void 0?A(r):e},_e=[0,31,60,91,121,152,182,213,244,274,305,335],Re=[0,31,59,90,120,151,181,212,243,273,304,334],ir={},Br=()=>{if(!or){var r={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.language||"C").replace("-","_")+".UTF-8",_:B||"./this.program"},e;for(e in ir)ir[e]===void 0?delete r[e]:r[e]=ir[e];var t=[];for(e in r)t.push(`${e}=${r[e]}`);or=t}return or},or,We=[null,[],[]];if(i.noExitRuntime&&(Or=i.noExitRuntime),i.print&&(z=i.print),i.printErr&&(R=i.printErr),i.wasmBinary&&(X=i.wasmBinary),i.thisProgram&&(B=i.thisProgram),i.preInit)for(typeof i.preInit=="function"&&(i.preInit=[i.preInit]);0<i.preInit.length;)i.preInit.shift()();var M,ur,Dr,x,S,T,Me={a:(r,e,t,n)=>K(`Assertion failed: ${Z(r)}, at: `+[e?Z(e):"unknown filename",t,n?Z(n):"unknown function"]),g:(r,e,t)=>{var n=new te(r);throw v[n.aa+16>>2]=0,v[n.aa+4>>2]=e,v[n.aa+8>>2]=t,Rr=r,Rr},D:()=>K(""),n:(r,e,t,n,a)=>{e=A(e),n=n===0n;let o=u=>u;if(n){const u=8*t;o=s=>BigInt.asUintN(u,s),a=o(a)}O(r,{name:e,W:o,Y:(u,s)=>(typeof s=="number"&&(s=BigInt(s)),s),$:Wr(e,t,!n),Z:null})},I:(r,e,t,n)=>{e=A(e),O(r,{name:e,W:function(a){return!!a},Y:function(a,o){return o?t:n},$:function(a){return this.W(I[a])},Z:null})},F:r=>O(r,ae),m:(r,e,t)=>{e=A(e),O(r,{name:e,W:n=>n,Y:(n,a)=>a,$:ie(e,t),Z:null})},q:(r,e,t,n,a,o)=>{var u=le(e,t);r=A(r),r=ge(r),a=ce(n,a),fe(r,function(){he(`Cannot call ${r} due to unbound types`,u)},e-1),pe(u,s=>{var f=r;s=ue(r,[s[0],null].concat(s.slice(1)),a,o);var h=e-1;if(!i.hasOwnProperty(f))throw new Sr("Replacing nonexistent public symbol");return i[f].X!==void 0&&h!==void 0?i[f].X[h]=s:(i[f]=s,i[f].ba=h),[]})},d:(r,e,t,n,a)=>{e=A(e);let o=s=>s;if(n===0){var u=32-8*t;o=s=>s<<u>>>u,a=o(a)}O(r,{name:e,W:o,Y:(s,f)=>f,$:Wr(e,t,n!==0),Z:null})},b:(r,e,t)=>{function n(o){return new a(q.buffer,v[o+4>>2],v[o>>2])}var a=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,BigInt64Array,BigUint64Array][e];t=A(t),O(r,{name:t,W:n,$:n},{ca:!0})},G:(r,e)=>{e=A(e),O(r,{name:e,W(t){var n=Z(t+4,v[t>>2],!0);return M(t),n},Y(t,n){n instanceof ArrayBuffer&&(n=new Uint8Array(n));var a=typeof n=="string";if(!(a||ArrayBuffer.isView(n)&&n.BYTES_PER_ELEMENT==1))throw new P("Cannot pass non-string to std::string");var o=a?Ur(n):n.length,u=ur(4+o+1),s=u+4;return v[u>>2]=o,a?k(n,s,o+1):I.set(n,s),t!==null&&t.push(M,u),u},$:nr,Z(t){M(t)}})},j:(r,e,t)=>{if(t=A(t),e===2)var n=we,a=me,o=de;else n=Ae,a=$e,o=Ee;O(r,{name:t,W:u=>{var s=n(u+4,v[u>>2]*e,!0);return M(u),s},Y:(u,s)=>{if(typeof s!="string")throw new P(`Cannot pass non-string to C++ string type ${t}`);var f=o(s),h=ur(4+f+e);return v[h>>2]=f/e,a(s,h+4,f+e),u!==null&&u.push(M,h),h},$:nr,Z(u){M(u)}})},J:(r,e)=>{e=A(e),O(r,{da:!0,name:e,W:()=>{},Y:()=>{}})},u:()=>{throw 1/0},p:(r,e,t)=>{var[n,...a]=Ie(r,e),o=n.Y.bind(n),u=a.map(f=>f.$.bind(f));r--;var s=Array(r);return e=`methodCaller<(${a.map(f=>f.name)}) => ${n.name}>`,Pe(xr(e,(f,h,y,$)=>{for(var U=0,g=0;g<r;++g)s[g]=u[g]($+U),U+=8;switch(t){case 0:var C=W(f).apply(null,s);break;case 2:C=Reflect.construct(W(f),s);break;case 3:C=s[0];break;case 1:C=W(f)[Cr(h)](...s)}return f=[],C=o(f,C),f.length&&(v[y>>2]=J(f)),C}))},H:tr,o:(r,e,t,n,a)=>ar[r](e,t,n,a),K:r=>J(Cr(r)),M:()=>J({}),L:r=>{for(var e=W(r);e.length;){var t=e.pop();e.pop()(t)}tr(r)},r:(r,e,t)=>{r=W(r),e=W(e),t=W(t),r[e]=t},w:function(r,e){r=-9007199254740992>r||9007199254740992<r?NaN:Number(r),r=new Date(1e3*r),m[e>>2]=r.getSeconds(),m[e+4>>2]=r.getMinutes(),m[e+8>>2]=r.getHours(),m[e+12>>2]=r.getDate(),m[e+16>>2]=r.getMonth(),m[e+20>>2]=r.getFullYear()-1900,m[e+24>>2]=r.getDay();var t=r.getFullYear();m[e+28>>2]=(t%4!==0||t%100===0&&t%400!==0?Re:_e)[r.getMonth()]+r.getDate()-1|0,m[e+36>>2]=-(60*r.getTimezoneOffset()),t=new Date(r.getFullYear(),6,1).getTimezoneOffset();var n=new Date(r.getFullYear(),0,1).getTimezoneOffset();m[e+32>>2]=(t!=n&&r.getTimezoneOffset()==Math.min(n,t))|0},x:(r,e,t,n)=>{var a=new Date().getFullYear(),o=new Date(a,0,1).getTimezoneOffset();a=new Date(a,6,1).getTimezoneOffset(),v[r>>2]=60*Math.max(o,a),m[e>>2]=+(o!=a),e=u=>{var s=Math.abs(u);return`UTC${0<=u?"-":"+"}${String(Math.floor(s/60)).padStart(2,"0")}${String(s%60).padStart(2,"0")}`},r=e(o),e=e(a),a<o?(k(r,t,17),k(e,n,17)):(k(r,n,17),k(e,t,17))},C:()=>Date.now(),v:r=>{var e=I.length;if(r>>>=0,2147483648<r)return!1;for(var t=1;4>=t;t*=2){var n=e*(1+.2/t);n=Math.min(n,r+100663296);r:{n=(Math.min(2147483648,65536*Math.ceil(Math.max(r,n)/65536))-V.buffer.byteLength+65535)/65536|0;try{V.grow(n),$r();var a=1;break r}catch{}a=void 0}if(a)return!0}return!1},z:(r,e)=>{var t=0,n=0,a;for(a of Br()){var o=e+t;v[r+n>>2]=o,t+=k(a,o,1/0)+1,n+=4}return 0},A:(r,e)=>{var t=Br();v[r>>2]=t.length,r=0;for(var n of t)r+=Ur(n)+1;return v[e>>2]=r,0},E:r=>{throw Or||(i.onExit?.(r),Q=!0),new re(r)},B:()=>52,y:function(){return 70},l:(r,e,t,n)=>{for(var a=0,o=0;o<t;o++){var u=v[e>>2],s=v[e+4>>2];e+=8;for(var f=0;f<s;f++){var h=r,y=I[u+f],$=We[h];y===0||y===10?(h=h===1?z:R,y=er($,0),y=_r.decode($.buffer?$.subarray(0,y):new Uint8Array($.slice(0,y))),h(y),$.length=0):$.push(y)}a+=s}return v[n>>2]=a,0},t:Te,k:De,s:Ce,i:xe,e:Se,h:Be,f:Ue,c:function(r){console.log(Z(r))}};function xe(r,e,t,n,a){var o=T();try{return _.get(r)(e,t,n,a)}catch(u){if(S(o),u!==u+0)throw u;x(1,0)}}function Se(r,e){var t=T();try{_.get(r)(e)}catch(n){if(S(t),n!==n+0)throw n;x(1,0)}}function Te(r,e){var t=T();try{return _.get(r)(e)}catch(n){if(S(t),n!==n+0)throw n;x(1,0)}}function Ue(r,e,t,n){var a=T();try{_.get(r)(e,t,n)}catch(o){if(S(a),o!==o+0)throw o;x(1,0)}}function Ce(r,e,t,n){var a=T();try{return _.get(r)(e,t,n)}catch(o){if(S(a),o!==o+0)throw o;x(1,0)}}function Be(r,e,t){var n=T();try{_.get(r)(e,t)}catch(a){if(S(n),a!==a+0)throw a;x(1,0)}}function De(r,e,t){var n=T();try{return _.get(r)(e,t)}catch(a){if(S(n),a!==a+0)throw a;x(1,0)}}var j;return j=await(async function(){function r(t){return j=t.exports,V=j.N,$r(),_=j.Q,t=j,M=t.P,ur=t.R,Dr=t.S,x=t.T,S=t.U,T=t.V,j}var e={a:Me};return i.instantiateWasm?new Promise(t=>{i.instantiateWasm(e,(n,a)=>{t(r(n))})}):(rr??=i.locateFile?i.locateFile("libImage.wasm",D):D+"libImage.wasm",r((await Kr(e)).instance))})(),(function(){function r(){if(i.calledRun=!0,!Q){if(Ar=!0,j.O(),pr?.(i),i.onRuntimeInitialized?.(),i.postRun)for(typeof i.postRun=="function"&&(i.postRun=[i.postRun]);i.postRun.length;){var e=i.postRun.shift();Pr.push(e)}Er(Pr)}}if(i.preRun)for(typeof i.preRun=="function"&&(i.preRun=[i.preRun]);i.preRun.length;)ee();Er(Ir),i.setStatus?(i.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>i.setStatus(""),1),r()},1)):r()})(),Ar?E=i:E=new Promise((r,e)=>{pr=r,gr=e}),E}})();typeof l=="object"&&typeof c=="object"&&(c.exports=p,c.exports.default=p)}}),Vr=l=>{const c=self;return c.addEventListener("message",async p=>{const d=p.data;if(d.type==="function"){const{name:w,value:E,callback:i}=d.payload,B=l[w];if(B)try{const D=E.map((L,z)=>i[z]?(...R)=>Hr(c,z,R):L);c.postMessage({type:"result",payload:await B(...D)})}catch(D){c.postMessage({type:"error",payload:String(D)})}}}),c.postMessage(void 0),l},Hr=(l,c,p)=>{const d=br.id++;return new Promise(w=>{l.addEventListener("message",E=>{const i=E.data;i.type==="callback_result"&&i.payload.id===d&&w(i.payload.result)},{once:!0}),l.postMessage({type:"callback",payload:{id:d,index:c,value:p}})})},br={id:0},Gr=(l,c)=>{const p=l?{...l,data:Uint8Array.from(l.data)}:void 0;return c(),p},Jr=async({image:l,width:c=0,height:p=0,quality:d=100,format:w="webp",libImage:E})=>vr({image:l,width:c,height:p,quality:d,format:w,libImage:E}).then(i=>i?.data),vr=async({image:l,width:c=0,height:p=0,quality:d=100,format:w="webp",libImage:E})=>E.then(({optimize:i,releaseResult:B})=>Gr(i(l,c,p,d,w),B)),hr=Promise.resolve().then(()=>Zr(Lr())).then(l=>l.default({}));Vr({optimizeImage:async l=>Jr({...l,libImage:hr}),optimizeImageExt:async l=>vr({...l,libImage:hr})})})()),sr}Yr()})();
